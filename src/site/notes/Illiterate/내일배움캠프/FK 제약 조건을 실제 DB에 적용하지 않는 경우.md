---
{"dg-publish":true,"permalink":"/illiterate//fk-db/","tags":["외래키","FK"],"noteIcon":"","created":"2025-02-14T23:47:00","updated":"2025-03-12T02:46:55+09:00"}
---

## 1. 성능 이슈

FK 제약조건을 적용하면 **데이터 무결성을 자동으로 보장**할 수 있지만, 그만큼 **삽입/수정/삭제 시 성능 오버헤드**가 발생한다.

• **INSERT** 시 부모 테이블에 해당 키가 있는지 확인해야 함 → **추가적인 조회 비용 발생**
• **DELETE/UPDATE** 시 참조 무결성을 유지해야 함 → **CASCADE 처리로 인해 성능 저하 가능**
• 특히, **대량의 데이터 삽입(ETL, 배치 작업 등)** 시 성능이 크게 떨어질 수 있음

  

➡ **대량 트랜잭션이 많은 서비스(예: 로그 시스템, 빅데이터 분석용 테이블)에서는 FK 제약조건을 배제하고, 애플리케이션에서 무결성을 관리하는 방식**을 선택할 수 있음.

## 2. 배포 및 마이그레이션의 유연성

FK가 걸려 있으면 **스키마 변경이 어려워질 수 있다.**

• 부모 테이블을 변경하려고 할 때, **FK가 걸린 자식 테이블을 먼저 변경해야 하는 문제 발생**
• 테이블 삭제(DDL 변경) 시 FK 때문에 **삭제 순서를 맞추기 어려움**
• 특히 **DB 마이그레이션이 빈번한 경우, FK가 장애가 될 가능성이 있음**

**마이크로서비스 아키텍처(MSA)나 빠르게 변경되는 서비스에서는 FK를 배제하고, 코드로 관계를 관리하는 경우가 많음.**

## 3. 분산 시스템에서의 FK 제약

• FK는 **같은 DB 내에서만 동작**함.
• **마이크로서비스 아키텍처(MSA)**에서는 테이블이 서로 다른 **DBMS 또는 인스턴스에 존재할 수 있음** → FK를 사용할 수 없음.
• 대신 **애플리케이션 레벨에서 무결성을 관리**하는 방식 사용 (예: @Transactional + Service Layer에서 검증).

**MSA 환경에서는 FK를 사용하지 않는 것이 일반적**이고, **데이터베이스 간 FK 참조는 불가능**하므로 애플리케이션 레벨에서 무결성을 보장해야 함.

## 4. 애플리케이션에서 무결성 관리

FK 없이도 애플리케이션 레벨에서 무결성을 관리할 수 있음.
• **Spring, JPA, Hibernate 같은 ORM 프레임워크**를 사용할 경우, **객체 연관 관계를 통해 FK 역할을 대신할 수 있음**

```
@Entity
public class Order {
    @Id @GeneratedValue
    private Long id;

    @ManyToOne // FK 역할을 함
    @JoinColumn(name = "customer_id")
    private Customer customer;
}
```

• DB에는 FK를 설정하지 않지만, **애플리케이션이 FK처럼 동작하면서 무결성을 보장**
• 이렇게 하면 **DB 제약 없이 유연한 데이터 관리 가능**

**ORM을 활용하면 FK 없이도 객체 연관을 통해 무결성을 보장할 수 있음.**

##  5. 복잡한 FK 관계 관리의 어려움

• 다중 FK 관계가 많아지면 **테이블 설계가 복잡해지고, 변경이 어려워진다**.
• 예를 들어, **순환 참조가 발생하는 FK 관계**는 테이블 삭제 및 갱신을 어렵게 만듦.
• 일부 프로젝트에서는 **FK 관계를 테이블 설계 명세에만 유지하고, 실제 DB에는 FK를 적용하지 않음**.

**관리 복잡성을 줄이기 위해 FK를 생략하는 경우가 많음.**


## 6. 언제 FK를 사용하는 것이 좋은가?

• **작은 규모의 프로젝트**에서 **데이터 무결성을 강력하게 보장하고 싶을 때**
• **ORM을 사용하지 않는 프로젝트**에서 데이터 참조 관계를 강제하고 싶을 때
• **단일 DB에서 작동하는 전통적인 모놀리식(Monolithic) 아키텍처**

FK는 데이터 무결성을 보장하지만, 운영 환경에 따라 제거하는 것이 더 유리할 수도 있음.
특히, **MSA, 성능 최적화, 유연한 마이그레이션이 필요한 경우에는 FK 없이 애플리케이션이 무결성을 관리하는 방식**이 더 많이 사용됨.